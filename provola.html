<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Movies & Series con Preferiti</title>
<style>
body{font-family:Arial,sans-serif;background:#141414;color:#fff;margin:0;padding:20px;}
h1{color:#fff;text-align:center;margin-bottom:20px;}
.controls{display:flex;gap:10px;justify-content:center;margin-bottom:20px;}
input,select{padding:8px;font-size:14px;border-radius:4px;border:none;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;}
.card{position:relative;cursor:pointer;transition: transform 0.2s;border-radius:12px;overflow:hidden;border:2px solid #444;background:#1f1f1f;}
.card:hover{transform:scale(1.05);border-color:#e50914;background:#2a2a2a;}
.poster{width:100%;border-radius:0;display:block;}
.badge{position:absolute;top:8px;right:8px;background:#e50914;color:#fff;padding:4px 6px;font-size:14px;font-weight:bold;border-radius:8px;text-align:center;}
.favorite-btn{position:absolute;top:8px;left:8px;background:rgba(0,0,0,0.7);border:none;color:#fff;padding:4px 6px;border-radius:50%;cursor:pointer;font-size:14px;}
.favorite-btn.active{background:#ffd700;color:#000;}
#infoCard{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(34,34,34,0.9);display:none;z-index:1001;backdrop-filter:blur(8px);color:#fff;padding:20px;overflow:auto;}
#infoCard h2{margin-top:0;color:#e50914;}
#closeCardBtn{margin-top:10px;padding:8px 12px;background:#e50914;border:none;color:#fff;border-radius:5px;cursor:pointer;}
</style>
</head>
<body>
<h1>Movies & Series (Demo con Preferiti)</h1>

<div class="controls">
<select id="typeSelect">
  <option value="all">Tutti</option>
  <option value="movie">Film</option>
  <option value="tv">Serie TV</option>
  <option value="favorites">⭐ Preferiti</option>
</select>
<input type="text" id="searchBox" placeholder="Cerca...">
</div>

<div id="moviesGrid" class="grid"></div>

<div id="infoCard">
  <h2 id="infoTitle"></h2>
  <p id="infoOverview"></p>
  <button id="closeCardBtn">Chiudi</button>
</div>

<script>
// --- DATI DI TEST ---
const allData = [
  {id:1,title:"Inception",poster:"https://image.tmdb.org/t/p/w300/qmDpIHrmpJINaRKAfWQfftjCdyi.jpg",genres:["Azione","Sci-Fi"],overview:"Un ladro che ruba segreti nei sogni.",type:"movie"},
  {id:2,title:"Breaking Bad",poster:"https://image.tmdb.org/t/p/w300/eSzpy96DwBujGFj0xMbXBcGcfxX.jpg",genres:["Crime","Dramma"],overview:"Un professore diventa produttore di metanfetamine.",type:"tv"},
  {id:3,title:"Interstellar",poster:"https://image.tmdb.org/t/p/w300/rAiYTfKGqDCRIIqo664sY9XZIvQ.jpg",genres:["Avventura","Sci-Fi"],overview:"Esploratori viaggiano attraverso un wormhole.",type:"movie"}
];

// --- PREFERITI SALVATI ---
let favorites = JSON.parse(localStorage.getItem("favorites") || "[]");

const grid = document.getElementById("moviesGrid");
const infoCard = document.getElementById("infoCard");
const infoTitle = document.getElementById("infoTitle");
const infoOverview = document.getElementById("infoOverview");
const closeCardBtn = document.getElementById("closeCardBtn");

closeCardBtn.onclick = () => infoCard.style.display = "none";

function toggleFavorite(id){
  if(favorites.includes(id)){
    favorites = favorites.filter(f => f !== id);
  } else {
    favorites.push(id);
  }
  localStorage.setItem("favorites", JSON.stringify(favorites));
  render(true);
}

function openInfo(item){
  infoCard.style.display = "block";
  infoTitle.textContent = item.title;
  infoOverview.textContent = item.overview;
}

function render(reset){
  grid.innerHTML = "";
  const type = document.getElementById("typeSelect").value;
  const search = document.getElementById("searchBox").value.toLowerCase();

  let list = allData.filter(m=>{
    if(type==="favorites") return favorites.includes(m.id);
    if(type!=="all" && m.type!==type) return false;
    if(search && !m.title.toLowerCase().includes(search)) return false;
    return true;
  });

  list.forEach(m=>{
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img class="poster" src="${m.poster}" alt="${m.title}">
      <div class="badge">${m.genres[0]||""}</div>
      <button class="favorite-btn ${favorites.includes(m.id)?"active":""}">★</button>
    `;
    card.querySelector(".favorite-btn").onclick = (e)=>{e.stopPropagation();toggleFavorite(m.id)};
    card.onclick = ()=>openInfo(m);
    grid.appendChild(card);
  });
}

document.getElementById("typeSelect").onchange=()=>render(true);
document.getElementById("searchBox").oninput=()=>render(true);

render(true);
</script>
</body>
</html>
